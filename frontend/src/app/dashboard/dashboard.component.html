<div class="refill-reminder" *ngIf="getRefillSoonList().length > 0">
  <h3>Refill reminders</h3>
  <ul>
    <li *ngFor="let med of getRefillSoonList()">
      ⚠️ {{ med.name }} — refill by {{ med.refillDate | date:'mediumDate' }}
    </li>
  </ul>
</div>

<br>

<div class="med-checker">
  <h2>Medications for today</h2>

  <div *ngIf="loading" class="placeholder">Loading…</div>
  <div *ngIf="error" class="error">{{ error }}</div>

  <div *ngIf="!loading && medications.length === 0" class="empty">
    No medications scheduled for today.
  </div>

  <ul class="med-list" *ngIf="!loading && medications.length > 0">
    <li *ngFor="let med of medications" [class.taken]="checked[med.id]" [class.missed]="isMissed(med)">
      <label>
        <input type="checkbox" [checked]="checked[med.id]" (change)="toggle(med)" />
        <div class="med-info">
          <div class="med-name">{{ med.name }}</div>
          <div class="med-meta">
            {{ med.dose || '' }}
            <span *ngIf="med.scheduleTime">• {{ med.scheduleTime }}</span>
          </div>
        </div>
      </label>
      <div *ngIf="isMissed(med)" class="warning">
        ⚠️ Missed dose — scheduled for {{ med.scheduleTime }}
      </div>
    </li>
  </ul>

  <div class="actions" *ngIf="!loading && medications.length > 0">
    <button type="button" (click)="markAllTaken()">Mark all taken</button>
    <button type="button" (click)="clearToday()">Clear</button>
    <button type="button" (click)="fetchForToday()">Refresh</button>
  </div>
</div>